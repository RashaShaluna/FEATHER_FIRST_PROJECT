<%- include('../adminlayouts/header') %>

<style>
  input[type="text"],
  input[type="number"],
  textarea {
    width: 30%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-sizing: border-box;
  }

  html, body {
    height: 100%;
    margin: 0;
  }

  .main-panel {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  .content-wrapper {
    flex: 1;
  }

  .back-button {
    color: white;
    background-color: #1cc0a0;
    border: none;
    padding: 10px 20px;
    text-decoration: none;
    border-radius: 5px;
  }

  .back-button:hover {
    background-color: white;
    color: #1cc0a0;
    border: 1px solid #1cc0a0;
  }

  .sub-btn {
    color: white;
    background-color: #1cc0a0;
    border: none;
    border-radius: 5px;
  }

  .sub-btn:hover {
    background-color: white;
    color: #1cc0a0;
    border: 1px solid #1cc0a0;
  }

  .header-flex {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .error-message {
    color: red;
    display: none;
  }
</style>

<div class="main-panel">
  <div class="content-wrapper">
    <div class="col-lg-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <div class="mb-3">
            <h3 class="card-title fs-5">Add Product</h3>
          </div>
          <section class="content-main">
            <div class="row">
              <div class="col-9"></div>
              <div class="col-lg-6">
                <div class="card mb-4">
                  <div class="card-body">
                    <form method="POST" action="/your-post-url" enctype="multipart/form-data" onsubmit="return validateForm()">
                      <div class="mb-4">
                        <label for="productName" class="form-label">Product Name</label>
                        <input type="text" placeholder="Type here" name="productName" class="form-control border" id="productName">
                        <div id="productName-error" class="error-message">Product name is required.</div>
                      </div>
                      <div class="col-lg-4 mb-4">
                        <label class="form-label">Brand</label>
                        <select class="form-select border" name="brand">
                          <option value="">Select a brand</option>
                          <!-- Populate options here -->
                        </select>
                        <div id="brand-error" class="error-message">Brand is required.</div>
                      </div>
                      <div class="mb-4">
                        <label class="form-label">Full description</label>
                        <textarea placeholder="Type here" id="descriptionid" name="description" class="form-control border" rows="4"></textarea>
                        <div id="description-error" class="error-message">Description is required.</div>
                      </div>
                      <div class="row">
                        <div class="col-lg-4">
                          <div class="mb-4">
                            <label class="form-label">Regular price</label>
                            <input placeholder="$" name="regularPrice" type="text" class="form-control border" id="regularPrice">
                            <div id="regularPrice-error" class="error-message">Valid regular price is required.</div>
                          </div>
                        </div>
                        <div class="col-lg-4">
                          <div class="mb-4">
                            <label class="form-label">Sale price</label>
                            <input placeholder="$" name="salePrice" type="text" class="form-control border" id="offerPrice">
                            <div id="offerPrice-error" class="error-message">Valid sale price is required.</div>
                          </div>
                        </div>
                        <div class="col-lg-4">
                          <div class="mb-4">
                            <label class="form-label">Quantity</label>
                            <input placeholder="" name="quantity" type="text" class="form-control border" id="quantity">
                            <div id="quantity-error" class="error-message">Valid quantity is required.</div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-lg-4">
                          <div class="mb-4">
                            <label class="form-label">Color</label>
                            <input name="color" type="text" class="form-control border" id="productColor">
                            <div id="color-error" class="error-message">Color is required.</div>
                          </div>
                        </div>
                      </div>
                      <div class="card mb-4">
                        <div class="card-body">
                          <div class="row gx-2">
                            <div class="col-sm-6 mb-3">
                              <label class="form-label">Category</label>
                              <select class="form-select border" name="category" id="category">
                                <option value="">Select a category</option>
                                <!-- Populate options here -->
                              </select>
                              <div id="category-error" class="error-message">Category is required.</div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="card mb-2">
                        <div class="card-header">
                          <h4>Choose images</h4>
                        </div>
                        <div class="border row">
                          <div id="addedImagesContainer" class="thumbnails-container"></div>
                        </div>
                        <div class="row">
                          <div class="card-body align-items-center" style="margin-bottom: 20px;">
                            <img src="" alt="" id="imgView1">
                            <input class="form-control" type="file" name="images" id="image1" accept="image/png, image/jpeg, image/jpg" onchange="viewImage(event, 1)">
                            <div id="image1-error" class="error-message">Image is required.</div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="card-body align-items-center" style="margin-bottom: 20px;">
                            <img src="" alt="" id="imgView2">
                            <input class="form-control" type="file" name="images" id="image2" accept="image/png, image/jpeg, image/jpg" onchange="viewImage(event, 2)">
                            <div id="image2-error" class="error-message">Image is required.</div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="card-body align-items-center" style="margin-bottom: 20px;">
                            <img src="" alt="" id="imgView3">
                            <input class="form-control" type="file" name="images" id="image3" accept="image/png, image/jpeg, image/jpg" onchange="viewImage(event, 3)">
                            <div id="image3-error" class="error-message">Image is required.</div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="card-body align-items-center" style="margin-bottom: 20px;">
                            <img src="" alt="" id="imgView4">
                            <input class="form-control" type="file" name="images" id="image4" accept="image/png, image/jpeg, image/jpg" onchange="viewImage(event, 4)">
                            <div id="image4-error" class="error-message">Image is required.</div>
                          </div>
                        </div>
                      </div>
                      <div>
                        <button class="btn btn-md rounded font-sm hover-up" type="submit">Publish</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </section>
          <a href="/admin/category" class="back-button mt-3 btn">Back to Category</a>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('../adminlayouts/footer') %>

<script>
  function validateForm() {
    let isValid = true;

    // Product Name validation
    const productName = document.getElementById('productName');
    const nameError = document.getElementById('productName-error');
    if (productName.value.trim() === "") {
      nameError.style.display = "block";
      isValid = false;
    } else {
      nameError.style.display = "none";
    }

    // Color validation
    const productColor = document.getElementById('productColor');
    const colorError = document.getElementById('color-error');
    if (productColor.value.trim() === "") {
      colorError.style.display = "block";
      isValid = false;
    } else {
      colorError.style.display = "none";
    }

    // Description validation
    const description = document.getElementById('descriptionid');
    const descriptionError = document.getElementById('description-error');
    if (description.value.trim() === "") {
      descriptionError.style.display = "block";
      isValid = false;
    } else {
      descriptionError.style.display = "none";
    }

    // Regular Price validation
    const regularPrice = document.getElementById('regularPrice');
    const regularPriceError = document.getElementById('regularPrice-error');
    if (regularPrice.value.trim() === "" || isNaN(regularPrice.value) || Number(regularPrice.value) <= 0) {
      regularPriceError.style.display = "block";
      isValid = false;
    } else {
      regularPriceError.style.display = "none";
    }

    // Offer Price validation
    const offerPrice = document.getElementById('offerPrice');
    const offerPriceError = document.getElementById('offerPrice-error');
    if (offerPrice.value.trim() === "" || isNaN(offerPrice.value) || Number(offerPrice.value) <= 0) {
      offerPriceError.style.display = "block";
      isValid = false;
    } else {
      offerPriceError.style.display = "none";
    }

    // Quantity validation
    const quantity = document.getElementById('quantity');
    const quantityError = document.getElementById('quantity-error');
    if (quantity.value.trim() === "" || isNaN(quantity.value) || Number(quantity.value) <= 0) {
      quantityError.style.display = "block";
      isValid = false;
    } else {
      quantityError.style.display = "none";
    }

    // Brand validation
    const brand = document.querySelector('select[name="brand"]');
    const brandError = document.getElementById('brand-error');
    if (brand.value === "") {
      brandError.style.display = "block";
      isValid = false;
    } else {
      brandError.style.display = "none";
    }

    // Category validation
    const category = document.getElementById('category');
    const categoryError = document.getElementById('category-error');
    if (category.value === "") {
      categoryError.style.display = "block";
      isValid = false;
    } else {
      categoryError.style.display = "none";
    }

    // Image validation
    const images = document.querySelectorAll('input[type="file"]');
    images.forEach((image, index) => {
      const imageError = document.getElementById(`image${index + 1}-error`);
      if (image.files.length === 0) {
        imageError.style.display = "block";
        isValid = false;
      } else {
        imageError.style.display = "none";
      }
    });

    return isValid;
  }

  function viewImage(event, imgNumber) {
    const reader = new FileReader();
    reader.onload = function() {
      const output = document.getElementById(`imgView${imgNumber}`);
      output.src = reader.result;
    }
    reader.readAsDataURL(event.target.files[0]);
  }
</script>
